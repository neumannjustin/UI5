<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>





<meta name="abstract" content="The OData Model enables binding of controls to data from OData services."/>
<meta name="description" content="The OData Model enables binding of controls to data from OData services."/>

<link rel="stylesheet" type="text/css" href="css/documentation.css?x=806662478110117"/>
<title>Instantiating an OData Model</title>
<!--[if lte IE 7]><style>
      .codeblock{
          overflow:visible;
      }</style><![endif]-->

  <script src="../../resources/sap/ui/thirdparty/jquery.js"></script>
    <script src="../../resources/sap/ui/demokit/js/highlight-query-terms.js"></script>
    <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/themes/base/highlight-query-terms.css" />
    <script src="../../resources/sap/ui/demokit/js/google-code-prettify/run_prettify.js"></script>
    <script src="../../resources/sap/ui/demokit/js/google-code-prettify/lang-css.js"></script>
    <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/js/google-code-prettify/prettify.css" />
  </head>
<body class="" id="loio6c47b2b39db9404582994070ec3d57a2">
<div id="wrapper"><div id="container">
<h1 class="title topictitle1">Instantiating an OData Model</h1>
<div class="body"><p class="shortdesc">The OData Model enables binding of controls to data from OData services.</p>
<p class="p">The OData model is a server-side model, meaning that the dataset is only available on the
			server and the client only knows the currently visible (requested) data. Operations,
			such as sorting and filtering, are done on the server. The client sends a request to the
			server and shows the returned data.</p>
<p class="p">The OData model currently supports OData version 2.0.</p>
<p class="p">The following two versions of the OData model are implemented:
				<samp class="ph codeph">sap.ui.model.odata.ODataModel</samp> and
				<samp class="ph codeph">sap.ui.model.odata.v2.ODataModel</samp>. The
				<samp class="ph codeph">v2.ODataModel</samp> has an improved feature set and new features will
			only be implemented in this model. <samp class="ph codeph">sap.ui.model.odata.ODataModel</samp> is
			deprecated. We recommend to only use <samp class="ph codeph">v2.ODataModel</samp>.</p>
<p class="p">The following table shows the supported features for both OData models:</p>
<table summary="" id="loio6c47b2b39db9404582994070ec3d57a2__simpletable_hmd_jlr_qr" border="1" class="simpletable"><tr class="sthead"><th valign="bottom" align="left" id="d2508488e37" class="stentry" width="33.333333333333336%">
					<p class="p">Feature</p>

				</th>
<th valign="bottom" align="left" id="d2508488e42" class="stentry" width="33.333333333333336%">
					<p class="p"><samp class="ph codeph">sap.ui.model.odata.v2.ODataModel</samp></p>

				</th>
<th valign="bottom" align="left" id="d2508488e48" class="stentry" width="33.333333333333336%">
					<p class="p"><samp class="ph codeph">sap.ui.model.odata.ODataModel</samp></p>

				</th>
</tr>
<tr class="strow"><td valign="top" headers="d2508488e37" class="stentry">
					<p class="p">OData version support</p>

				</td>
<td valign="top" headers="d2508488e42" class="stentry">
					<p class="p">2.0</p>

				</td>
<td valign="top" headers="d2508488e48" class="stentry">
					<p class="p">2.0</p>

				</td>
</tr>
<tr class="strow"><td valign="top" headers="d2508488e37" class="stentry">
					<p class="p">JSON format</p>

				</td>
<td valign="top" headers="d2508488e42" class="stentry">
					<p class="p">Yes (default)</p>

				</td>
<td valign="top" headers="d2508488e48" class="stentry">
					<p class="p">Yes</p>

				</td>
</tr>
<tr class="strow"><td valign="top" headers="d2508488e37" class="stentry">
					<p class="p">XML format</p>

				</td>
<td valign="top" headers="d2508488e42" class="stentry">
					<p class="p">Yes</p>

				</td>
<td valign="top" headers="d2508488e48" class="stentry">
					<p class="p">Yes (default)</p>

				</td>
</tr>
<tr class="strow"><td valign="top" headers="d2508488e37" class="stentry">
					<p class="p">Support of two-way binding mode</p>

				</td>
<td valign="top" headers="d2508488e42" class="stentry">
					<p class="p">Yes; for property changes only, not yet implemented for aggregations</p>

				</td>
<td valign="top" headers="d2508488e48" class="stentry">
					<p class="p">Experimental; only properties of one entity can be changed at the same time</p>

				</td>
</tr>
<tr class="strow"><td valign="top" headers="d2508488e37" class="stentry">
					<p class="p">Default binding mode</p>

				</td>
<td valign="top" headers="d2508488e42" class="stentry">
					<p class="p">One-way binding</p>

				</td>
<td valign="top" headers="d2508488e48" class="stentry">
					<p class="p">One-way binding</p>

				</td>
</tr>
<tr class="strow"><td valign="top" headers="d2508488e37" class="stentry">
					<p class="p">Client-side sorting and filtering</p>

				</td>
<td valign="top" headers="d2508488e42" class="stentry">
					<p class="p">Yes; see <a class="xref" href="../../docs/api/symbols/sap.ui.model.odata.OperationMode">sap.ui.model.odata.OperationMode</a>
						<span class="ph"> in the API
						reference</span></p>

				</td>
<td valign="top" headers="d2508488e48" class="stentry">
					<p class="p">No</p>

				</td>
</tr>
<tr class="strow"><td valign="top" headers="d2508488e37" class="stentry">
					<p class="p">$batch</p>

				</td>
<td valign="top" headers="d2508488e42" class="stentry">
					<p class="p">Yes; all requests can be batched</p>

				</td>
<td valign="top" headers="d2508488e48" class="stentry">
					<p class="p">Only manual batch requests are possible</p>

				</td>
</tr>
<tr class="strow"><td valign="top" headers="d2508488e37" class="stentry">
					<p class="p">Data cache in model</p>

				</td>
<td valign="top" headers="d2508488e42" class="stentry">
					<p class="p">All data is cached in the model</p>

				</td>
<td valign="top" headers="d2508488e48" class="stentry">
					<p class="p">Manually requested data is <span class="ph emphasis emphasis">not</span> cached</p>

				</td>
</tr>
<tr class="strow"><td valign="top" headers="d2508488e37" class="stentry">
					<p class="p">Automatic refresh</p>

				</td>
<td valign="top" headers="d2508488e42" class="stentry">
					<p class="p">Yes (default)</p>

				</td>
<td valign="top" headers="d2508488e48" class="stentry">
					<p class="p">Yes</p>

				</td>
</tr>
<tr class="strow"><td valign="top" headers="d2508488e37" class="stentry">
					<p class="p">Message handling</p>

				</td>
<td valign="top" headers="d2508488e42" class="stentry">
					<p class="p">Yes, see <a class="xref" href="62b1481d3e084cb49dd30956d183c6a0.html">Managing UI and Server Messages</a></p>

				</td>
<td valign="top" headers="d2508488e48" class="stentry">
					<p class="p">No</p>

				</td>
</tr>
</table>
<div class="note note"><span class="notetitle">Note</span> 
			<p class="p">Be aware of the Same-Origin-Policy security concept which prevents access to backends
				on different domains or sites.</p>

		</div>
<p class="p">The requests to the service to fetch data are made automatically based on the data
			bindings that are defined for the controls.</p>
<div class="section"><div class="section_title">Creating the Model Instance</div><div type="Creating the Model Instance">
			
			<p class="p">One OData model instance can only cover one OData service. For accessing multiple services,
				you have to create multiple OData model instances. The only mandatory parameter when
				creating an ODataModel instance is the service URL. It can be passed as first
				parameter or within the <samp class="ph codeph">mParameters</samp> map to the constructor.</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
var oModel = new sap.ui.model.odata.v2.ODataModel("http://services.odata.org/Northwind/Northwind.svc/");
var oModel = new sap.ui.model.odata.v2.ODataModel({serviceUrl: "http://services.odata.org/Northwind/Northwind.svc"});</pre></div>

			<p class="p">When creating an ODataModel instance, a request is sent to retrieve the service
				metadata:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint ">http://services.odata.org/Northwind/Northwind.svc/$metadata</pre></div>

		</div></div>
<div class="section"><div class="section_title">Service Metadata</div><div type="Service Metadata">
			
			<p class="p">The service metadata is cached per service URL. Multiple OData models that are using the same
				service can share this metadata. Only the first model instance triggers a
					<samp class="ph codeph">$metadata</samp> request. A JSON representation of the service
				metadata can be accessed by calling the <samp class="ph codeph">getServiceMetadata()</samp> method
				on an Odata model instance.</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
var oMetadata = oModel.getServiceMetadata();</pre></div>

			<div class="note note"><span class="notetitle">Note</span> 
				<p class="p">In the <samp class="ph codeph">v2.ODataModel</samp>, the service metadata is loaded
					asynchronously. It is not possible to load it synchronously. To get notified
					when the loading is finished, attach the <samp class="ph codeph">metadataLoaded</samp>
					event.</p>

			</div>

		</div></div>
<div class="section"><div class="section_title">Adding Additional URL Parameters</div><div type="Adding Additional URL Parameters">
			
			<p class="p">For OData services, you can use URL parameters for configuration. <span class="ph"><span class="ph pname">OpenUI5</span></span> sets most URL
				parameters automatically, according to the respective binding.</p>

			<p class="p">For authentication tokens or general configration options, for example, you can add
				additional arguments to the request URL. Some of the parameters must  not be
				included in every request, but should only be added to specific aggregation or
				element bindings, such as <samp class="ph codeph">$expand</samp> or <samp class="ph codeph">$select</samp>. For
				this, the binding methods provide the option to pass a map of parameters, which are
				then included in all requests for this specific binding. The OData model currently
				only supports <samp class="ph codeph">$expand</samp> and <samp class="ph codeph">$select</samp>.</p>

			<p class="p">There are different ways to add URL parameters to the requests:</p>

			<ul class="ul" id="loio6c47b2b39db9404582994070ec3d57a2__ul_xwk_5mx_qr"><li class="li">
					<p class="p">Appending parameters to the service URL:</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
var oModel = new sap.ui.model.odata.v2.ODataModel("http://myserver/MyService.svc/?myParam=value&amp;myParam2=value");</pre></div>

					<p class="p">These parameters will be included in every request sent to the OData
						server.</p>

				</li>
<li class="li">
					<p class="p">Passing URL parameters with the <samp class="ph codeph">mparameters</samp> map</p>

					<p class="p">You can pass URL parameters that are used for <samp class="ph codeph">$metadata</samp>
						requests only (<samp class="ph codeph">metadataUrlParams</samp>) as well as URL parameters
						that are included only in data requests (<samp class="ph codeph">serviceUrlParams</samp>).
						The parameters are passed as maps:</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
var oModel = new sap.ui.model.odata.v2.ODataModel({ 
    serviceUrl: "http://services.odata.org/Northwind/Northwind.svc",    
    serviceUrlParams: {
        myParam: "value1",
        myParam2: "value2"
    },
    metadataUrlParams: {
        myParam: "value1",
        myParam2: "value2"
    }
});</pre></div>

				</li>
</ul>

		</div></div>
<div class="section"><div class="section_title">Custom HTTP Headers</div><div type="Custom HTTP Headers">
			
			<p class="p">You can add custom headers which are sent with each request. To do this, provide a map of
				headers to the OData model constructor or use the <samp class="ph codeph">setHeaders()</samp>
				function:</p>

			<ul class="ul" id="loio6c47b2b39db9404582994070ec3d57a2__ul_ts1_xnx_qr"><li class="li">
					<p class="p">Passing custom headers with the <samp class="ph codeph">mparameters</samp> map</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
var oModel = new sap.ui.model.odata.v2.ODataModel({
    headers: {
        "myHeader1" : "value1",
        "myHeader2" : "value2"
    }
});</pre></div>

				</li>
<li class="li">
					<p class="p">Setting custom headers globally on a model instance</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
oModel.setHeaders({"myHeader1" : "value1", "myHeader2" : "value2"});</pre></div>

					<div class="note note"><span class="notetitle">Note</span> 
						<p class="p">When you add custom headers, all previous custom headers are removed if not specified again
							in the headers map. Some headers are private, that is, they are set by
							the OData model internally and cannot be set:</p>

						<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint ">"accept"
"accept-language"
"maxdataserviceversion"
"dataserviceversion"
"x-csrf-token"</pre></div>

						<p class="p">For additional methods and parameters, see <a class="xref" href="../../docs/api/symbols/sap.ui.model.odata.v2.ODataModel">sap.ui.model.odata.v2.ODataModel</a>.</p>

					</div>

				</li>
</ul>

		</div></div>
<div class="section"><div class="section_title">Addressing Entities: Binding Path Sytnax</div><div type="Addressing Entities: Binding Path Sytnax">
			
			<p class="p">The binding path syntax for OData models matches the URL path relative to the service
				URL used in OData to access specific entities or entity sets.</p>

			<p class="p">You access the data provided by the OData model according to the structure of the OData
				service as defined in the metadata of a service. URL parameters, such as filters,
				cannot be added to a binding path. A binding path can be absolute or relative.
				Absolute binding paths are resolved immediately. A relative path can only be
				resolved if it can be automatically converted into an absolute binding path. If, for
				example, a property is bound to a relative path and the parent control is then bound
				to an absolute path, the relative property path can e resolved to an absolute
				path.</p>

			<p class="p">The following binding samples within the ODataModel are taken from the Northwind demo
				service.</p>

			<p class="p">Absolute binding path (starting with a slash ('/')): </p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint ">"/Customers"
"/Customers('ALFKI')/Address"</pre></div>

			<p class="p">Relative binding paths that can be resolved with a context (for example
				"/Customer('ALFKI')"): </p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint ">"CompanyName"
"Address"
"Orders"</pre></div>

			<p class="p">Resolved to:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint ">"/Customer('ALFKI')/CompanyName"
"/Customer('ALFKI')/Address"
"/Customer('ALFKI')/Orders"</pre></div>

			<p class="p">Navigation properties, used to identify a single entity or a collection of
				entities:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint ">"/Customers('ALFKI')/Orders"
"/Products(1)/Supplier"</pre></div>

			<p class="p">For more information on addressing OData entries, see the URI conventions documentation on
					<a class="extlink" href="http://help.sap.com/disclaimer?site=http://www.odata.org" alt="http://www.odata.org" title="http://www.odata.org">http://www.odata.org<img src="images/3rd_link.png" class="link-external" alt="Information published on non-SAP site" title="Information published on non-SAP site" border="0"/></a>.</p>

		</div></div>
<div class="section"><div class="section_title">Accessing Data from an OData Model</div><div type="Accessing Data from an OData Model">
			
			<p class="p">The data requested from an OData service is cached in the OData model. It can be accessed by
				the <samp class="ph codeph">getData()</samp> and the <samp class="ph codeph">getProperty()</samp> method, which
				returns the entity object or value. These methods do not request data from the
				backend, so you can only access already requested and cached entities:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
oModel.getData("/Customer('ALFKI')");
oModel.getProperty("/Customer('ALFKI')/Address");</pre></div>

			<p class="p">You can only access single entities and properties with these methods. To access entity sets,
				you can get the binding contexts of all read entities via a list binding. The values
				returned by these methods are copies of the data in the model, not references as in
				the JSONModel.</p>

			<div class="note caution"><span class="cautiontitle">Caution</span> 
				<p class="p">Do <span class="ph emphasis emphasis">not</span> modify objects or values inside the model manually;
					always use the provided API to change data in the model, or use two-way binding
					(see <em class="ph i">Two-way Binding</em> section below).</p>

			</div>

		</div></div>
<div class="section"><div class="section_title">Creating Entities</div><div type="Creating Entities">
			
			<p class="p">To create entities for a specified entity set, call the
					<samp class="ph codeph">createEntry()</samp> method. The method returns a context object that
				points to the newly created entity. The application can bind against these objects
				and change the data by means of two-way binding. To store the entities in the OData
				backend, the application calls <samp class="ph codeph">submitChanges()</samp>. To reset the
				changes, the application can call the <samp class="ph codeph">deleteCreatedEntry()</samp>
				method.</p>

			<p class="p">The application can choose the properties that shall be included in the created
				object and can pass its own default values for these properties. Per default, all
				property values are be empty, that is, undefined.</p>

			<div class="note note"><span class="notetitle">Note</span> 
				<p class="p">The entity set and the passed properties must exist in the metadata definition of
					the OData service.</p>

				<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint ">// create an entry of the Products collection with the specified properties and values
var oContext = oModel.createEntry("Products", { ID:99, Name:"Product", Description:"new Product", ReleaseDate:new Date(), Price:"10.1", Rating:1});
// binding against this entity
oForm.setBindingContext(oContext);
// submit the changes (creates entity at the backend)
oModel.submitChanges({success: mySuccessHandler, error: myErrorHandler});
// delete the created entity
oModel.deleteCreatedEntry(oContext);
</pre></div>

				<p class="p">If created entities are submitted, the context is updated with the path returned
					from the creation request and the new data is imported into the model. So the
					context is still valid and points to the new created entity. </p>

			</div>

		</div></div>
<div class="section"><div class="section_title">CRUD Operations</div><div type="CRUD Operations">
			
			<p class="p">The OData model allows manual CRUD (create, read, update, delete) operations on the OData
				service. If a manual operation returns data, the data is imported into the data
				cache of the OData model. All operations require a mandatory <samp class="ph codeph">sPath</samp>
				parameter as well as an optional <samp class="ph codeph">mParameters</samp> map. The
					<samp class="ph codeph">create</samp> and <samp class="ph codeph">update</samp> methods also require a
				mandatory <samp class="ph codeph">oData</samp> parameter for passing the created or changed data
				object. Each operation returns an object containing a function abort, which can be
				used to abort the request. If the request is aborted, the error handler is called.
				This ensures that the success or the error handler is executed for every request. It
				is also possible to pass additional header data, URL parameters, or an eTag.</p>

			<ul class="ul" id="loio6c47b2b39db9404582994070ec3d57a2__ul_zwr_wgy_qr"><li class="li">
					<p class="p">Creating entities</p>

					<p class="p">The <samp class="ph codeph">create</samp> function triggers a <samp class="ph codeph">POST</samp> request to an OData
						service which was specified at creation of the OData model. The application
						has to specify the entity set, in which the new entity and the entity data
						is to be created.</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
var oData = {
    ProductId: 999,
    ProductName: "myProduct"
}
oModel.create("/Products", oData, {success: mySuccessHandler, error: myErrorHandler});</pre></div>

				</li>
<li class="li">
					<p class="p">Reading entities</p>

					<p class="p">The <samp class="ph codeph">read</samp> function triggeres a <samp class="ph codeph">GET</samp> request to a specified
						path. The path is retrieved from the OData service which was specified at
						creation of the OData model. The retrieved data is returned in the
							<samp class="ph codeph">success</samp> callback handler function.</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
oModel.read("/Products(999)", {success: mySuccessHandler, error: myErrorHandler});</pre></div>

				</li>
<li class="li">
					<p class="p">Updating entities</p>

					<p class="p">The <samp class="ph codeph">update</samp> function triggers a <samp class="ph codeph">PUT</samp>/<samp class="ph codeph">MERGE</samp>
						request to an OData service which was specified at creation of the OData
						model. After a successful request to update the bindings in the model, the
						refresh is triggered automatically.</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
var oData = {
    ProductId: 999,
    ProductName: "myProductUpdated"
}
oModel.update("/Products(999)", oData, {success: mySuccessHandler, error: myErrorHandler});</pre></div>

				</li>
<li class="li">
					<p class="p">Deleting entities</p>

					<p class="p">The <samp class="ph codeph">remove</samp> function triggers a <samp class="ph codeph">DELETE</samp> request to an OData
						service which was specified at creation of the OData model. The application
						has to specify the path to the entry which should be deleted.</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
oModel.delete("/Products(999)", {success: mySuccessHandler, error: myErrorHandler});</pre></div>

				</li>
<li class="li">
					<p class="p">Refresh after change</p>

					<p class="p">The model provides a mechanism to automatically refresh bindings that depend on changed
						entities. If you carry out a <samp class="ph codeph">create</samp>,
							<samp class="ph codeph">update</samp> or <samp class="ph codeph">delete</samp> function, the model
						identifies the bindings and triggers a refresh for these bindings. If the
						model runs in batch mode, the refresh requests are bundled together with the
						changes in the same batch request. You can disable the auto refresh by
						calling <samp class="ph codeph">setRefreshAfterChange(false)</samp>. If the auto refresh
						is disabled, the application has to take care of refreshing the respective
						bindings.</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
oModel.setRefreshAfterChange(false);</pre></div>

				</li>
</ul>

		</div></div>
<div class="section"><div class="section_title">Concurrency Control and ETags</div><div type="Concurrency Control and ETags">
			
			<p class="p">OData uses HTTP ETags for optimistic concurrency control. The service must be configured to
				provide them. The ETag can be passed within the parameters map for every CRUD
				request. If no ETag is passed, the ETag of the cached entity is used, if it is
				loaded already.</p>

		</div></div>
<div class="section"><div class="section_title">XSFR Token</div><div type="XSFR Token">
			
			<p class="p">To address cross-site request forgery, an OData service may require XSRF tokens for change
				requests by the client application. In this case, the client has to fetch a token
				from the server and send it with each change request to the server. The OData model
				fetches the XSRF token when reading the metadata and then automatically sends it
				with each write request header. If the token is no longer valid, a new token can be
				fetched by calling the <samp class="ph codeph">refreshSecurityToken</samp> function on the OData
				model. The token is fetched with a request to the service document. To ensure
				getting a valid token, make sure that the service document is
					<span class="ph emphasis emphasis">not</span> cached.</p>

		</div></div>
<div class="section"><div class="section_title">Refreshing the Model</div><div type="Refreshing the Model">
			
			<p class="p">The <samp class="ph codeph">refresh</samp> function refreshes all data within an OData model. Each binding
				reloads its data from the server. For list or element bindings, a new request to the
				backend is triggered. If the XSRF token is no longer valid, it has to be fetched
				again with a <samp class="ph codeph">read</samp> request to the service document. Data that has
				been imported via manual CRUD requests is <span class="ph emphasis emphasis">not</span> reloaded
				automatically.</p>

		</div></div>
<div class="section"><div class="section_title">Batch Processing</div><div type="Batch Processing">
			
			<p class="p">The <samp class="ph codeph">v2.ODataModel</samp> supports batch processing
				(<samp class="ph codeph">$batch</samp>) in two different ways:</p>

			<ul class="ul" id="loio6c47b2b39db9404582994070ec3d57a2__ul_pwr_jnt_rr"><li class="li">
					<p class="p">Default: All requests in a thread are collected and bundled in batch
						requests, meaning that request is sent in a timeout immediately after the
						current call stack is finished. This includes all manual CRUD requests as
						well as requests triggered by a binding.</p>

				</li>
<li class="li">
					<p class="p">The requests are stored and can be submitted with a manual
							<samp class="ph codeph">submitChanges()</samp> call by the application. This also
						includes all manual CRUD requests as well as requests triggered by a
						binding.</p>

				</li>
</ul>

			<p class="p">The model cannot decide how to bundle the requests. For this, SAPUI5 provides the
					<samp class="ph codeph">batchGroupId</samp>. For each binding and each manual request, a
					<samp class="ph codeph">batchGroupId</samp> can be specified. All requests belonging to the
				same group are bundled into one batch request. Request without a
					<samp class="ph codeph">batchGroupId</samp> are bundled in the default batch group. You can
				use a <samp class="ph codeph">changeSetId</samp> for changes. The same principle applies: Each
				change belonging to the same <samp class="ph codeph">changeSetId</samp> is bundled into one
					<samp class="ph codeph">changeSet</samp> in the batch request. Per default, all changes have
				their own <samp class="ph codeph">changeSet</samp>. For more information, see the API
				reference.</p>

			<p class="p">You can use the the <samp class="ph codeph">setDeferredBatchGroups()</samp> method to set each
					<samp class="ph codeph">batchGroup</samp> to deferred: All requests belonging to the
					<samp class="ph codeph">batchGroup</samp> are then stored in a request queue. The deferred
				batch group must then be submitted manually by means of the
					<samp class="ph codeph">submitChanges()</samp> method. If you do <span class="ph emphasis emphasis">not</span>
				specify a batch group ID when calling <samp class="ph codeph">submitChanges</samp>, all deferred
				batch groups are submitted.</p>

			<p class="p"><span class="ph emphasis emphasis">Example:</span></p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
var oModel = new sap.ui.model.odata.v2.ODataModel(myServiceUrl);</pre></div>

			<p class="p">Pass the <samp class="ph codeph">batchGroupId</samp> to a binding:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
{path:"/myEntities", parameters: {batchGroupId: "myId"}}</pre></div>

			<p class="p">Set the <samp class="ph codeph">batchGroupId</samp> to deferred:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
oModel.setDeferredBatchGroups(["myGroupId", "myGroupId2"]);</pre></div>

			<p class="p">Submit a deferred <samp class="ph codeph">batchGroup</samp>:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
oModel.submitChanges({batchGroupId: "myGroupId", success: mySuccessHandler, error: myErrorHandler});</pre></div>

		</div></div>
<div class="section"><div class="section_title">Two-way Binding</div><div type="Two-way Binding">
			
			<p class="p">The <samp class="ph codeph">v2.ODataModel</samp> enables two-way binding. Per default, all changes are
				collected in a batch group called "changes" which is set to deferred. To submit the
				changes, use <samp class="ph codeph">submitChanges()</samp>. The data changes are made on a data
				copy. This enables you to reset the changes without sending a new request to the
				backend to fetch the old data again. With <samp class="ph codeph">resetChanges()</samp> you can
				reset all changes. You can also reset only specific entities by calling
					<samp class="ph codeph">resetChanges</samp> with an array of entity paths.</p>

			<div class="note note"><span class="notetitle">Note</span> 
				<p class="p">Filtering and sorting is not possible if two-way changes are present as this
					would cause inconsistent data on the UI. Therefore, before you carry out sorting
					or filtering, you have to submit or reset the changes.</p>

			</div>

			<p class="p">You can collect the changes for different entities or types in different batch
				groups. To configure this, use the <samp class="ph codeph">setChangeBatchGroups()</samp> method of
				the model:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
var oModel = new sap.ui.model.odata.v2.ODataModel(myServiceUrl);
oModel.setDeferredBatchGroups(["myGroupId", "myGroupId2"]);
oModel.setChangeBatchGroups({
    "EntityTypeName": {
        batchGroupId: "myGroupId",  
        [changeSetId: "ID",]
        [single: true/false,]
    }
);
oModel.submitChanges({batchGroupId: "myGroupId", success: mySuccessHandler, error: myErrorHandler});</pre></div>

			<p class="p">To collect the changes for all entity types in the same batch group, use '*â€™ as
					<samp class="ph codeph">EntityType</samp>. If the change is not set to deferred, the changes
				are sent to the backend immediately. By setting the <samp class="ph codeph">single</samp>
				parameter for <samp class="ph codeph">changeSet</samp> to true or false, you define if a change is
				assigned its own change set (<samp class="ph codeph">true</samp>) or if all changes are collected
				in one change set (<samp class="ph codeph">false</samp>). The model only takes care of the
					<samp class="ph codeph">changeSetId</samp> if <samp class="ph codeph">single</samp> is set to
					<samp class="ph codeph">false</samp>.</p>

			<div class="note note"><span class="notetitle">Note</span> 
				<p class="p">The first change of an entity defines the order in the change set.</p>

			</div>

			<p class="p"><span class="ph emphasis emphasis">Example</span></p>

			<p class="p">Reset changes:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
var oModel = new sap.ui.model.odata.v2.ODataModel(myServiceUrl);
//do a change
oModel.setProperty("/myEntity(0)", oValue);

//reset the change
oModel.resetChanges(["/myEntity(0)"]);</pre></div>

		</div></div>
<div class="section"><div class="section_title">Binding-specific Parameters</div><div type="Binding-specific Parameters">
			
			<p class="p">The OData protocol specifies different URL parameters. You can use these parameters in
				bindings in addition to the parameters described above:</p>

			<ul class="ul" id="loio6c47b2b39db9404582994070ec3d57a2__ul_yf1_w3y_qr"><li class="li">
					<p class="p">Expand parameter</p>

					<p class="p">The <samp class="ph codeph">expand</samp> parameter allows the application to read associated entities
						with their navigation properties:</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
oControl.bindElement("/Category(1)", {expand: "Products"}); 

oTable.bindRows({
    path: "/Products",
    parameters: {expand: "Category"}
});</pre></div>

					<p class="p">In this example, all products of "Category(1)" are embedded inline in the server response
						and loaded in one request. The category for all "Products" is embedded
						inline in the response for each product.</p>

				</li>
<li class="li">
					<p class="p">Select parameter</p>

					<p class="p">The <samp class="ph codeph">select</samp> parameter allows the application to define a subset of
						properties that is read when requesting an entity.</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
oControl.bindElement("/Category(1)", {expand: "Products", select: "Name,ID,Products"}); 

oTable.bindRows({
    path: "/Products",
    parameters: {select: "Name,Category"}
});</pre></div>

					<p class="p">In this example, the properties <samp class="ph codeph">Name</samp>, <samp class="ph codeph">ID</samp> and
							<samp class="ph codeph">ofCategory(1)</samp> as well as all properties of the embedded
						products are returned. The properties <samp class="ph codeph">Name</samp> and
							<samp class="ph codeph">Category</samp> are included for each product. The
							<samp class="ph codeph">Category</samp> property contains a link to the related
						category entry.</p>

				</li>
<li class="li">
					<p class="p">Custom query options</p>

					<p class="p">You can use custom query options as input parameters for service operations. When creating
						the aggregation binding, specify these custom parameter as follows:</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
oTable.bindRows({
        path: "/Products", 
        parameters: {
        custom: {
            param1: "value1",
            param2: "value2"
        }
    },
    template: rowTemplate
});</pre></div>

					<p class="p">If you use <samp class="ph codeph">bindElement</samp>, you can specify custom parameters as follows:</p>

					<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint "><samp class="ph codeph">#!js</samp>
oTextField.bindElement("/GetProducts", {
    custom: {
        "price" : "500"
    }
});</pre></div>

				</li>
</ul>

		</div></div>
</div>
</div></div>

<SCRIPT LANGUAGE="JavaScript"><!--
 var page_title="Instantiating an OData Model";

        if (page_title !='' &&
        parent.document.title != null) {
 parent.document.title =
          page_title;
 } 
 var
        anchor = document.getElementById(location.hash.substring(+1)); if (typeof (anchor)
        !='undefined' && anchor !=null){
        var top = anchor.getBoundingClientRect().top; } 
//-->
</SCRIPT>
</body>
</html>